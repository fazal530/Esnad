<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Count on View</title>
  <style>
    .stat { font: 600 48px/1.1 system-ui, Arial, sans-serif; }
  </style>
</head>
<body>

  <!-- Your counter -->
  <span class="stat counter" data-target="2401" data-duration="1500">0</span>

  <script>
    // Format numbers with commas (e.g., 2,401)
    const format = new Intl.NumberFormat();

    // Animate a number from start -> end in "duration" ms
    function animateValue(el, start, end, duration) {
      const startTime = performance.now();
      function frame(now) {
        const progress = Math.min((now - startTime) / duration, 1);
        // ease-out
        const eased = 1 - Math.pow(1 - progress, 3);
        const value = Math.round(start + (end - start) * eased);
        el.textContent = format.format(value);
        if (progress < 1) requestAnimationFrame(frame);
      }
      requestAnimationFrame(frame);
    }

    // Start when element becomes visible
    function setupCounter(el) {
      const end = parseInt(el.dataset.target.replace(/,/g, ''), 10) || 0;
      const duration = parseInt(el.dataset.duration, 10) || 1200;
      let started = false;

      const start = () => {
        if (started) return;
        started = true;
        animateValue(el, 0, end, duration);
      };

      if ('IntersectionObserver' in window) {
        const io = new IntersectionObserver(entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              start();
              io.unobserve(el);
            }
          });
        }, { threshold: 0.35 });
        io.observe(el);
      } else {
        // Fallback: start immediately
        start();
      }
    }

    // Initialize all counters on the page
    document.querySelectorAll('.counter').forEach(setupCounter);
  </script>
</body>
</html>
